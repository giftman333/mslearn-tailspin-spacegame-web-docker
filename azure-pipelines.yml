### YamlMime:Yaml
ms.openlocfilehash: 92b7fa2bfb2da11da7b621069e809af45eba977d
ms.sourcegitcommit: ac2ef45a787885996570376b660e03e9f559531d
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 05/19/2021
ms.locfileid: "109935421"

trigger:
- '*'

variables:
  # buildConfiguration: 'Release'
  webRepository: web
  tag: $(Build.BuildId)

stages:
- stage: Build
  displayName: Build and push
  jobs:
    - job: Build
      displayName: Build job
      pool:
        vmImage: ubuntu-18.04
      steps:
        - task: Docker@2
          displayName: Build and push the image to container registry
          inputs:
            command: buildAndPush
            buildContext: $(Build.Repository.LocalPath)
            repository: $(webRepository)
            dockerfile: $(Build.SourcesDirectory)/Tailspin.SpaceGame.Web/Dockerfile
            containerRegistry: Container Registry Connection
            tags: |
              $(tag)

- stage: Deploy
  displayName: Deploy the container
  dependsOn: Build
  jobs:
    - job: Deploy
      displayName: Deploy job
      pool:
        vmImage: ubuntu-18.04
      variables:
        - group: Release
      steps:
        - task: AzureWebAppContainer@1
          inputs:
            appName: $(WebAppName)
            azureSubscription: Resource Manager - Tailspin - Space Game
            imageName: '$(RegistryName)/$(webRepository):$(build.buildId)'
